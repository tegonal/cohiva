{% extends "geno/base.html" %}
{% load i18n unfold %}

{% block custom_content %}
{% component "unfold/components/card.html" %}
<div class="px-3 py-4 space-y-4">
  <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
    <h1 class="text-lg font-medium text-font-important-light dark:text-font-important-dark">Report-Output f√ºr {{ report.name }} <span class="text-sm text-gray-500 dark:text-gray-400">(Typ: {{ report.report_type.name }})</span></h1>
    {% component "unfold/components/button.html" with href="download/all/" %}
      {% trans "Alle Daten als ZIP-Datei herunterladen" %}
    {% endcomponent %}
  </div>

  {% if reportoutput_list %}
    <div class="space-y-6">
      {% for output in reportoutput_list %}
        {% ifchanged output.group %}
          {% if not forloop.first %}</div>{% endif %}
          <div class="space-y-3">
            <h3 class="text-sm font-semibold text-font-default-light dark:text-font-default-dark">{{ output.group }}</h3>
        {% endifchanged %}
        <div class="border border-base-200 dark:border-base-800 rounded-default p-3">
          <div class="text-sm font-medium text-font-important-light dark:text-font-important-dark mb-2">{{ output.name }}</div>
          {% if output.output_type == "text" %}
            <div class="bg-base-50 dark:bg-base-900/60 border border-base-200 dark:border-base-800 rounded-default px-3 py-2 text-sm text-font-default-light dark:text-font-default-dark whitespace-pre-wrap break-words max-h-52 overflow-auto">
              {{ output.value|linebreaks }}
            </div>
          {% else %}
            <div class="flex items-center gap-3 text-sm">
              <a class="text-primary-600 hover:underline dark:text-primary-400" href="download/{{ output.id }}/">{{ output.value }}</a>
              {% if output.regeneration_json %}
                <a class="text-sm text-gray-600 hover:underline dark:text-gray-300" href="regenerate/{{ output.id }}/">{% trans "Datei neu generieren" %}</a>
              {% endif %}
            </div>
          {% endif %}
        </div>
        {% if forloop.last %}</div>{% endif %}
      {% endfor %}
    </div>
  {% else %}
    <p class="text-sm text-font-default-light dark:text-font-default-dark">{% trans "Keine Report-Outputs vorhanden." %}</p>
  {% endif %}
</div>
{% endcomponent %}
{% endblock %}

{% block footer %}
  {% include "geno/components/form_footer.html" with form_id="None" button_text=_("Anzeige verlassen") display_back=True %}
{% endblock %}
