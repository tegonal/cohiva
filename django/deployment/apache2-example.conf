<VirtualHost>
  DocumentRoot /var/www/cohiva-demo/html
  ServerName demo.cohiva.ch
  ServerAdmin admin@example.com
  CustomLog ${APACHE_LOG_DIR}/sites/cohiva-demo_combined.log combined
  ErrorLog ${APACHE_LOG_DIR}/sites/cohiva-demo_error.log
  <Directory /var/www/cohiva-demo>
     AllowOverride AuthConfig FileInfo
  </Directory>

## START Django config
  Alias /robots.txt /var/www/cohiva-demo/django-production/static/robots.txt
  Alias /favicon.ico /var/www/cohiva-demo/django-production/static/favicon.ico
  Alias /apple-touch-icon.png                     /var/www/cohiva-demo/django-production/static/apple-touch-icon.png
  Alias /apple-touch-icon-precomposed.png         /var/www/cohiva-demo/django-production/static/apple-touch-icon-precomposed.png
  Alias /apple-touch-icon-120x120.png             /var/www/cohiva-demo/django-production/static/apple-touch-icon-120x120.png
  Alias /apple-touch-icon-120x120-precomposed.png /var/www/cohiva-demo/django-production/static/apple-touch-icon-120x120-precomposed.png
  Alias /apple-touch-icon-152x152.png             /var/www/cohiva-demo/django-production/static/apple-touch-icon-152x152.png
  Alias /apple-touch-icon-152x152-precomposed.png /var/www/cohiva-demo/django-production/static/apple-touch-icon-152x152-precomposed.png
  Alias /static/ /var/www/cohiva-demo/django-production/static/
  <Directory /var/www/cohiva-demo/django-production/static>
   Require all granted
   Options None
  </Directory>

  Alias /media/ /var/www/cohiva-demo/django-production/media/
  <Directory /var/www/cohiva-demo/django-production/media>
   Require all granted
   Options None
  </Directory>

  ## XSendfile for django-filer secure downloads (smedia)
  XSendFile On
  XSendFilePath /var/www/cohiva-demo/django-production/smedia/

  WSGIDaemonProcess cohiva-demo python-home=/home/cohiva/.venv/cohiva-demo-prod python-path=/var/www/cohiva-demo/django-production
  WSGIProcessGroup cohiva-demo
  WSGIApplicationGroup %{GLOBAL}
  WSGIScriptAlias / /var/www/cohiva-demo/django-production/cohiva/wsgi.py
  ## Needed for oauth!
  WSGIPassAuthorization On

  ## Increase I/O timeout to 2h for some Django operations -> needs improvement, i.e. use celery for long tasks!
  TimeOut 7200

  <Directory /var/www/cohiva-demo/django-production/cohiva>
   Options None
   <Files wsgi.py>
    Require all granted
   </Files>
  </Directory>
## END Django config
</VirtualHost>

## Django test/dev server
<VirtualHost>
  ServerName test.demo.cohiva.ch
  ServerAdmin admin@example.com
  CustomLog ${APACHE_LOG_DIR}/sites/cohiva-demo_test_combined.log combined
  ErrorLog ${APACHE_LOG_DIR}/sites/cohiva-demo_test_error.log

  ## Connect to Django dev server
  ProxyPass /  http://127.0.0.1:8003/
  ProxyPassReverse /  http://127.0.0.1:8003/

  ## Increase I/O timeout to 2h for some Django operations -> needs improvement, i.e. use celery for long tasks!
  TimeOut 7200

  ## XSendfile for django-filer secure downloads (smedia)
  XSendFile On
  XSendFilePath /var/www/g8/django-test/smedia/
</VirtualHost>

## PWA app server
<VirtualHost>
  DocumentRoot /var/www/cohiva-demo/pwa
  ServerName app.demo.cohiva.ch
  ServerAdmin admin@example.com
  CustomLog ${APACHE_LOG_DIR}/sites/cohiva-demo_pwa_combined.log combined
  ErrorLog ${APACHE_LOG_DIR}/sites/cohiva-demo_pwa_error.log

  ## PWA specific
  FileETag None
  Header unset ETag
  # disable browser cache for sw.js file (service worker)
  <FilesMatch "^(sw.js)$">
      Header unset Expires
      Header set Cache-Control "no-cache"
  </FilesMatch>
</VirtualHost>
